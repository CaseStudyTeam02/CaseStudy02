using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;

public class TitleManager : MonoBehaviour
{

    /**************************************************************************
    *	定数定義
    ***************************************************************************/
    SoundManager soundManager;  // サウンドマネージャ
    FadeManager fadeManager;    // フェードマネージャ
    InputManager inputManager;  // インプットマネージャ
    
    public int CloudSpawnTime;  // 雲オブジェクト生成フレーム数 ( UNITY側で設定可能 )
    private float SpawnTimeCnt; // 雲オブジェクト生成用カウンタ

    public string TitleBGM;//タイトル画面でのBGMのファイル名。ファイルパスではない

    /**************************************************************************
   *	定数定義
   ***************************************************************************/
    public enum TITLEMODE
    {
        MODE_PRESS, // 初期状態
        MODE_MENU,  // メニュー表示状態(1度タップした状態)
        MODE_SOUND, // サウンドメニュー状態(メニューからサウンドオブジェクトをタップした状態)
    };

    /**************************************************************************
    *	変数宣言
    ***************************************************************************/
    
    ////    プレハブ格納用
    //////////////////////////////////////////////////////////////////////
    public GameObject Cloud_Object;     // 雲オブジェクト
    public GameObject TitleMenu_Object; // タイトルメニューオブジェクト
    public GameObject TitleSoundToggle; // サウンドメニュー表示用ボタン

    ////    作成用
    //////////////////////////////////////////////////////////////////////
    GameObject Title_ToGame;            // ゲーム画面への遷移ボタン
    GameObject TitleSound;              // サウンドメニューへの遷移ボタン
    TITLEMODE mode;                     // タイトル画面のモード

    /**************************************************************************
    *	初期化処理
    ***************************************************************************/
    void Awake()
    {
        //--------------------------------------------------------------------------------------------//
        //			変数初期化
        //--------------------------------------------------------------------------------------------//
            SpawnTimeCnt = 0;   // 雲オブジェクトの生成カウンタ

            ////    マネージャ生成
            ////////////////////////////////////////////////////////////////////////////////////////////
            soundManager = SoundManager.Instance;
            fadeManager = FadeManager.Instance;
            inputManager = InputManager.Instance;

        //--------------------------------------------------------------------------------------------//
        //			タイトルモードを初期値に設定
        //--------------------------------------------------------------------------------------------//
        this.mode = TITLEMODE.MODE_PRESS;

        //--------------------------------------------------------------------------------------------//
        //			オブジェクト生成
        //--------------------------------------------------------------------------------------------//;
        ////    雲
        //////////////////////////////////////////////////////////
        GameObject Title_Cloud = Instantiate(Cloud_Object, null);
    }

    /**************************************************************************
   *	更新処理
   ***************************************************************************/
    void Update()
    {
        SoundManager.PlayBGM(TitleBGM);
        //--------------------------------------------------------------------------------------------//
        //			雲オブジェクト生成カウンタ加算
        //--------------------------------------------------------------------------------------------//
        SpawnTimeCnt += Time.deltaTime;

        //--------------------------------------------------------------------------------------------//
        //			オブジェクト生成
        //--------------------------------------------------------------------------------------------//

        ////    雲
        //////////////////////////////////////////////////////////
        if (SpawnTimeCnt > CloudSpawnTime)
        {
            GameObject Title_Cloud = Instantiate(Cloud_Object, null);
            SpawnTimeCnt = 0;
        }

        //--------------------------------------------------------------------------------------------//
        //			画面タップ認識(仮)
        //--------------------------------------------------------------------------------------------//
        ////    トリガー入力(タップ)
        /////////////////////////////////////////////////////////////////
        if (InputManager.GetTouchTrigger()){OnClickTrigger();}
    }

    /**************************************************************************
   *	トリガー入力時の処理
   ***************************************************************************/
    public void OnClickTrigger()
    {
        //--------------------------------------------------------------------------------------------//
        //			初期モード
        //--------------------------------------------------------------------------------------------//
        if (mode == TITLEMODE.MODE_PRESS)
        {
            ////    メニューモードへ変更
            //////////////////////////////////////////////////////////
            SetTitleMode(TITLEMODE.MODE_MENU);
        }
    }

    /**************************************************************************
    *	タイトルモード変更処理
    ***************************************************************************/
    public void SetTitleMode(TITLEMODE Changemode)
    {
        //--------------------------------------------------------------------------------------------//
        //			変更前のモード別の処理
        //--------------------------------------------------------------------------------------------//
        switch (mode)
        {
            ////    タイトル初期
            //////////////////////////////////////////////////////////
            case TITLEMODE.MODE_PRESS:
                break;

            ////    タイトルメニュー
            //////////////////////////////////////////////////////////
            case TITLEMODE.MODE_MENU:

                ////    破棄
                //////////////////////////////////////////////////////////
                Destroy(this.Title_ToGame);

                break;

            ////    サウンドメニュー
            //////////////////////////////////////////////////////////
            case TITLEMODE.MODE_SOUND:
                
                ////    破棄
                //////////////////////////////////////////////////////////
                Destroy(this.TitleSound);

                break;
        
        }
        
        //--------------------------------------------------------------------------------------------//
        //			変更先のモード別の処理
        //--------------------------------------------------------------------------------------------//
        switch (Changemode)
        {
            ////    タイトル初期
            //////////////////////////////////////////////////////////
            case TITLEMODE.MODE_PRESS:
                break;

            ////    タイトルメニュー
            //////////////////////////////////////////////////////////
            case TITLEMODE.MODE_MENU:

                ////    タイトルメニュー生成
                //////////////////////////////////////////////////////////
                //  ゲームシーンへ遷移するボタン
                GameObject Title_ToGame = Instantiate(TitleMenu_Object, null);
                
                ////    サウンドボタン生成
                //////////////////////////////////////////////////////////
                GameObject TitleSound = Instantiate(TitleSoundToggle, null); 
                
                break;
        }

        //--------------------------------------------------------------------------------------------//
        //		    現在のモードを変更
        //--------------------------------------------------------------------------------------------//
        mode = Changemode;
    
    }
}